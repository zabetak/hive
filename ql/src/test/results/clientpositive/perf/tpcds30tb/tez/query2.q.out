Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
Map 10 <- Map 6 (BROADCAST_EDGE), Union 11 (CONTAINS)
Map 13 <- Map 6 (BROADCAST_EDGE), Union 11 (CONTAINS)
Map 5 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
Map 6 <- Reducer 8 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
Reducer 12 <- Map 7 (BROADCAST_EDGE), Union 11 (SIMPLE_EDGE)
Reducer 3 <- Map 7 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (CUSTOM_SIMPLE_EDGE)
Reducer 9 <- Map 7 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 4 vectorized, llap
      File Output Operator [FS_253]
        Select Operator [SEL_252] (rows=11224 width=788)
          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
        <-Reducer 3 [SIMPLE_EDGE] vectorized, llap
          SHUFFLE [RS_251]
            Select Operator [SEL_250] (rows=11224 width=788)
              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
              Map Join Operator [MAPJOIN_249] (rows=11224 width=1572)
                Conds:MAPJOIN_248.(_col0 - 53)=RS_246._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16"]
              <-Reducer 12 [BROADCAST_EDGE] vectorized, llap
                BROADCAST [RS_246]
                  PartitionCols:_col0
                  Map Join Operator [MAPJOIN_245] (rows=367 width=788)
                    Conds:GBY_244._col0=RS_208._col0(Inner),Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                  <-Map 7 [BROADCAST_EDGE] vectorized, llap
                    PARTITION_ONLY_SHUFFLE [RS_208]
                      PartitionCols:_col0
                      Select Operator [SEL_205] (rows=367 width=4)
                        Output:["_col0"]
                        Filter Operator [FIL_203] (rows=367 width=8)
                          predicate:((d_year = 2001) and d_week_seq is not null)
                          TableScan [TS_20] (rows=73049 width=8)
                            default@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_week_seq","d_year"]
                  <-Group By Operator [GBY_244] (rows=11297 width=788)
                      Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)","sum(VALUE._col4)","sum(VALUE._col5)","sum(VALUE._col6)"],keys:KEY._col0
                    <-Union 11 [SIMPLE_EDGE]
                      <-Map 10 [CONTAINS] vectorized, llap
                        Reduce Output Operator [RS_263]
                          PartitionCols:_col0
                          Group By Operator [GBY_262] (rows=409945536 width=788)
                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col1)","sum(_col2)","sum(_col3)","sum(_col4)","sum(_col5)","sum(_col6)","sum(_col7)"],keys:_col0
                            Select Operator [SEL_261] (rows=64599747471 width=143)
                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                              Map Join Operator [MAPJOIN_260] (rows=64599747471 width=143)
                                Conds:SEL_259._col0=RS_227._col0(Inner),Output:["_col1","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10"]
                              <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_227]
                                  PartitionCols:_col0
                                  Select Operator [SEL_222] (rows=73049 width=40)
                                    Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
                                    Filter Operator [FIL_220] (rows=73049 width=103)
                                      predicate:(d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter)))
                                      TableScan [TS_8] (rows=73049 width=103)
                                        default@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_week_seq","d_day_name"]
                                      <-Reducer 9 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_218]
                                          Group By Operator [GBY_216] (rows=1 width=12)
                                            Output:["_col0","_col1","_col2"],aggregations:["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1000000)"]
                                      <-Reducer 9 [BROADCAST_EDGE] vectorized, llap
                                         Please refer to the previous BROADCAST [RS_218]
                                      <-Reducer 8 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_215]
                                          Group By Operator [GBY_214] (rows=1 width=12)
                                            Output:["_col0","_col1","_col2"],aggregations:["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1000000)"]
                              <-Select Operator [SEL_259] (rows=21594638446 width=119)
                                  Output:["_col0","_col1"]
                                  TableScan [TS_178] (rows=21594638446 width=119)
                                    default@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_ext_sales_price"]
                      <-Map 13 [CONTAINS] vectorized, llap
                        Reduce Output Operator [RS_268]
                          PartitionCols:_col0
                          Group By Operator [GBY_267] (rows=409945536 width=788)
                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col1)","sum(_col2)","sum(_col3)","sum(_col4)","sum(_col5)","sum(_col6)","sum(_col7)"],keys:_col0
                            Select Operator [SEL_266] (rows=64599747471 width=143)
                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                              Map Join Operator [MAPJOIN_265] (rows=64599747471 width=143)
                                Conds:SEL_264._col0=RS_230._col0(Inner),Output:["_col1","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10"]
                              <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_230]
                                  PartitionCols:_col0
                                   Please refer to the previous Select Operator [SEL_222]
                              <-Select Operator [SEL_264] (rows=43005109025 width=119)
                                  Output:["_col0","_col1"]
                                  TableScan [TS_190] (rows=43005109025 width=119)
                                    default@catalog_sales,catalog_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_ext_sales_price"]
              <-Map Join Operator [MAPJOIN_248] (rows=367 width=788)
                  Conds:GBY_247._col0=RS_206._col0(Inner),Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                <-Map 7 [BROADCAST_EDGE] vectorized, llap
                  PARTITION_ONLY_SHUFFLE [RS_206]
                    PartitionCols:_col0
                    Select Operator [SEL_204] (rows=367 width=4)
                      Output:["_col0"]
                      Filter Operator [FIL_202] (rows=367 width=8)
                        predicate:((d_year = 2002) and d_week_seq is not null)
                         Please refer to the previous TableScan [TS_20]
                <-Group By Operator [GBY_247] (rows=11297 width=788)
                    Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)","sum(VALUE._col4)","sum(VALUE._col5)","sum(VALUE._col6)"],keys:KEY._col0
                  <-Union 2 [SIMPLE_EDGE]
                    <-Map 1 [CONTAINS] vectorized, llap
                      Reduce Output Operator [RS_243]
                        PartitionCols:_col0
                        Group By Operator [GBY_242] (rows=409945536 width=788)
                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col1)","sum(_col2)","sum(_col3)","sum(_col4)","sum(_col5)","sum(_col6)","sum(_col7)"],keys:_col0
                          Select Operator [SEL_241] (rows=64599747471 width=143)
                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                            Map Join Operator [MAPJOIN_240] (rows=64599747471 width=143)
                              Conds:SEL_239._col0=RS_223._col0(Inner),Output:["_col1","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10"]
                            <-Map 6 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_223]
                                PartitionCols:_col0
                                Select Operator [SEL_221] (rows=73049 width=40)
                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
                                  Filter Operator [FIL_219] (rows=73049 width=103)
                                    predicate:(d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_51_date_dim_d_week_seq_min) AND DynamicValue(RS_51_date_dim_d_week_seq_max) and (d_week_seq - 53) BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_51_date_dim_d_week_seq_bloom_filter)) and in_bloom_filter((d_week_seq - 53), DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter)))
                                     Please refer to the previous TableScan [TS_8]
                            <-Select Operator [SEL_239] (rows=21594638446 width=119)
                                Output:["_col0","_col1"]
                                TableScan [TS_154] (rows=21594638446 width=119)
                                  default@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_ext_sales_price"]
                    <-Map 5 [CONTAINS] vectorized, llap
                      Reduce Output Operator [RS_258]
                        PartitionCols:_col0
                        Group By Operator [GBY_257] (rows=409945536 width=788)
                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col1)","sum(_col2)","sum(_col3)","sum(_col4)","sum(_col5)","sum(_col6)","sum(_col7)"],keys:_col0
                          Select Operator [SEL_256] (rows=64599747471 width=143)
                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                            Map Join Operator [MAPJOIN_255] (rows=64599747471 width=143)
                              Conds:SEL_254._col0=RS_226._col0(Inner),Output:["_col1","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10"]
                            <-Map 6 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_226]
                                PartitionCols:_col0
                                 Please refer to the previous Select Operator [SEL_221]
                            <-Select Operator [SEL_254] (rows=43005109025 width=119)
                                Output:["_col0","_col1"]
                                TableScan [TS_166] (rows=43005109025 width=119)
                                  default@catalog_sales,catalog_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_ext_sales_price"]

