Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
Map 5 <- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 3 vectorized, llap
      File Output Operator [FS_176]
        Select Operator [SEL_175] (rows=37800 width=406)
          Output:["_col0","_col1","_col2","_col3"]
        <-Reducer 2 [SIMPLE_EDGE] vectorized, llap
          SHUFFLE [RS_174]
            Select Operator [SEL_173] (rows=37800 width=518)
              Output:["_col0","_col1","_col2","_col4"]
              Group By Operator [GBY_172] (rows=37800 width=585)
                Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4
              <-Map 1 [SIMPLE_EDGE] vectorized, llap
                SHUFFLE [RS_171]
                  PartitionCols:_col0, _col1, _col2, _col3, _col4
                  Group By Operator [GBY_170] (rows=264600 width=585)
                    Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col2)"],keys:_col11, _col12, _col15, _col16, _col17
                    Map Join Operator [MAPJOIN_169] (rows=3496630 width=473)
                      Conds:MAPJOIN_168._col1=RS_164._col0(Inner),Output:["_col2","_col11","_col12","_col15","_col16","_col17"]
                    <-Map 9 [BROADCAST_EDGE] vectorized, llap
                      BROADCAST [RS_164]
                        PartitionCols:_col0
                        Select Operator [SEL_163] (rows=60 width=302)
                          Output:["_col0","_col1","_col2","_col3"]
                          TableScan [TS_28] (rows=60 width=302)
                            tpcds_bin_partitioned_orc_30000@call_center,call_center, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cc_call_center_sk","cc_call_center_id","cc_name","cc_manager"]
                    <-Map Join Operator [MAPJOIN_168] (rows=3496630 width=179)
                        Conds:MAPJOIN_167._col0=RS_162._col1(Inner),Output:["_col1","_col2","_col11","_col12"]
                      <-Map 5 [BROADCAST_EDGE] vectorized, llap
                        BROADCAST [RS_162]
                          PartitionCols:_col1
                          Select Operator [SEL_161] (rows=354764 width=187)
                            Output:["_col1","_col6","_col7"]
                            Map Join Operator [MAPJOIN_160] (rows=354764 width=187)
                              Conds:MAPJOIN_159._col2=RS_155._col0(Inner),Output:["_col0","_col5","_col6"]
                            <-Map 8 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_155]
                                PartitionCols:_col0
                                Select Operator [SEL_154] (rows=3600 width=8)
                                  Output:["_col0"]
                                  Filter Operator [FIL_153] (rows=3600 width=100)
                                    predicate:(hd_buy_potential like '0-500%')
                                    TableScan [TS_15] (rows=7200 width=100)
                                      tpcds_bin_partitioned_orc_30000@household_demographics,household_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["hd_demo_sk","hd_buy_potential"]
                            <-Map Join Operator [MAPJOIN_159] (rows=709527 width=187)
                                Conds:MAPJOIN_158._col3=RS_152._col0(Inner),Output:["_col0","_col2","_col5","_col6"]
                              <-Map 7 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_152]
                                  PartitionCols:_col0
                                  Select Operator [SEL_151] (rows=6666667 width=8)
                                    Output:["_col0"]
                                    Filter Operator [FIL_150] (rows=6666667 width=116)
                                      predicate:(ca_gmt_offset = -7)
                                      TableScan [TS_12] (rows=40000000 width=116)
                                        tpcds_bin_partitioned_orc_30000@customer_address,customer_address, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ca_address_sk","ca_gmt_offset"]
                              <-Map Join Operator [MAPJOIN_158] (rows=4257160 width=198)
                                  Conds:SEL_157._col1=RS_19._col0(Inner),Output:["_col0","_col2","_col3","_col5","_col6"]
                                <-Map 6 [BROADCAST_EDGE] llap
                                  BROADCAST [RS_19]
                                    PartitionCols:_col0
                                    Select Operator [SEL_11] (rows=109760 width=187)
                                      Output:["_col0","_col1","_col2"]
                                      Filter Operator [FIL_75] (rows=109760 width=187)
                                        predicate:((cd_marital_status) IN ('M', 'W') and (cd_education_status) IN ('Unknown             ', 'Advanced Degree     ') and (struct(cd_marital_status,cd_education_status)) IN (const struct('M','Unknown             '), const struct('W','Advanced Degree     ')))
                                        TableScan [TS_9] (rows=1920800 width=187)
                                          tpcds_bin_partitioned_orc_30000@customer_demographics,customer_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cd_demo_sk","cd_marital_status","cd_education_status"]
                                <-Select Operator [SEL_157] (rows=74500295 width=31)
                                    Output:["_col0","_col1","_col2","_col3"]
                                    Filter Operator [FIL_156] (rows=74500295 width=31)
                                      predicate:(c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null)
                                      TableScan [TS_6] (rows=80000000 width=31)
                                        tpcds_bin_partitioned_orc_30000@customer,customer, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["c_customer_sk","c_current_cdemo_sk","c_current_hdemo_sk","c_current_addr_sk"]
                      <-Map Join Operator [MAPJOIN_167] (rows=61191022 width=0)
                          Conds:SEL_166._col3=RS_146._col0(Inner),Output:["_col0","_col1","_col2"]
                        <-Map 4 [BROADCAST_EDGE] vectorized, llap
                          BROADCAST [RS_146]
                            PartitionCols:_col0
                            Select Operator [SEL_145] (rows=31 width=8)
                              Output:["_col0"]
                              Filter Operator [FIL_144] (rows=31 width=16)
                                predicate:((d_year = 1999) and (d_moy = 11))
                                TableScan [TS_3] (rows=73049 width=16)
                                  tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_year","d_moy"]
                          Dynamic Partitioning Event Operator [EVENT_149] (rows=15 width=8)
                            Group By Operator [GBY_148] (rows=15 width=8)
                              Output:["_col0"],keys:_col0
                              Select Operator [SEL_147] (rows=31 width=8)
                                Output:["_col0"]
                                 Please refer to the previous Select Operator [SEL_145]
                        <-Select Operator [SEL_166] (rows=4151176648 width=133)
                            Output:["_col0","_col1","_col2","_col3"]
                            Filter Operator [FIL_165] (rows=4151176648 width=133)
                              predicate:(cr_call_center_sk is not null and cr_returning_customer_sk is not null)
                              TableScan [TS_0] (rows=4320980099 width=133)
                                tpcds_bin_partitioned_orc_30000@catalog_returns,catalog_returns, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cr_returning_customer_sk","cr_call_center_sk","cr_net_loss"]

