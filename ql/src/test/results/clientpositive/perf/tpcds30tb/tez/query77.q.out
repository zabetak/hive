Warning: Map Join MAPJOIN[213][bigTable=?] in task 'Reducer 10' is a cross product
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 6 (BROADCAST_EDGE)
Map 11 <- Map 6 (BROADCAST_EDGE)
Map 13 <- Map 6 (BROADCAST_EDGE)
Map 15 <- Map 6 (BROADCAST_EDGE)
Map 7 <- Map 6 (BROADCAST_EDGE)
Map 9 <- Map 6 (BROADCAST_EDGE)
Reducer 10 <- Map 9 (SIMPLE_EDGE), Reducer 12 (BROADCAST_EDGE), Union 3 (CONTAINS)
Reducer 12 <- Map 11 (CUSTOM_SIMPLE_EDGE)
Reducer 14 <- Map 13 (SIMPLE_EDGE), Reducer 16 (BROADCAST_EDGE), Union 3 (CONTAINS)
Reducer 16 <- Map 15 (SIMPLE_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 8 (BROADCAST_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:100
    Stage-1
      Reducer 5 vectorized, llap
      File Output Operator [FS_282]
        Limit [LIM_281] (rows=100 width=441)
          Number of rows:100
          Select Operator [SEL_280] (rows=924 width=441)
            Output:["_col0","_col1","_col2","_col3","_col4"]
          <-Reducer 4 [SIMPLE_EDGE] vectorized, llap
            SHUFFLE [RS_279]
              Select Operator [SEL_278] (rows=924 width=441)
                Output:["_col0","_col1","_col2","_col3","_col4"]
                Group By Operator [GBY_277] (rows=924 width=449)
                  Output:["_col0","_col1","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"],keys:KEY._col0, KEY._col1, KEY._col2
                <-Union 3 [SIMPLE_EDGE]
                  <-Reducer 10 [CONTAINS] vectorized, llap
                    Reduce Output Operator [RS_298]
                      PartitionCols:_col0, _col1, _col2
                      Group By Operator [GBY_297] (rows=924 width=449)
                        Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col2)","sum(_col3)","sum(_col4)"],keys:_col0, _col1, 0L
                        Top N Key Operator [TNK_296] (rows=616 width=439)
                          keys:_col0, _col1,top n:100
                          Select Operator [SEL_295] (rows=8 width=443)
                            Output:["_col0","_col1","_col2","_col3","_col4"]
                            Map Join Operator [MAPJOIN_294] (rows=8 width=456)
                              Conds:(Inner),Output:["_col0","_col1","_col2","_col3","_col4"]
                            <-Reducer 12 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_292]
                                Group By Operator [GBY_291] (rows=1 width=224)
                                  Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
                                <-Map 11 [CUSTOM_SIMPLE_EDGE] vectorized, llap
                                  PARTITION_ONLY_SHUFFLE [RS_290]
                                    Group By Operator [GBY_289] (rows=1 width=224)
                                      Output:["_col0","_col1"],aggregations:["sum(_col0)","sum(_col1)"]
                                      Map Join Operator [MAPJOIN_288] (rows=480076034 width=183)
                                        Conds:SEL_287._col2=RS_241._col0(Inner),Output:["_col0","_col1"]
                                      <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_241]
                                          PartitionCols:_col0
                                          Select Operator [SEL_234] (rows=8116 width=8)
                                            Output:["_col0"]
                                            Filter Operator [FIL_233] (rows=8116 width=64)
                                              predicate:CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP'1998-08-04 00:00:00' AND TIMESTAMP'1998-09-03 00:00:00'
                                              TableScan [TS_3] (rows=73049 width=64)
                                                tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_date"]
                                      <-Select Operator [SEL_287] (rows=4320980099 width=227)
                                          Output:["_col0","_col1","_col2"]
                                          TableScan [TS_48] (rows=4320980099 width=227)
                                            tpcds_bin_partitioned_orc_30000@catalog_returns,catalog_returns, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cr_return_amount","cr_net_loss"]
                            <-Group By Operator [GBY_293] (rows=8 width=232)
                                Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
                              <-Map 9 [SIMPLE_EDGE] vectorized, llap
                                SHUFFLE [RS_286]
                                  PartitionCols:_col0
                                  Group By Operator [GBY_285] (rows=34240 width=231)
                                    Output:["_col0","_col1","_col2"],aggregations:["sum(_col1)","sum(_col2)"],keys:_col0
                                    Map Join Operator [MAPJOIN_284] (rows=4778018342 width=229)
                                      Conds:SEL_283._col3=RS_239._col0(Inner),Output:["_col0","_col1","_col2"]
                                    <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                      BROADCAST [RS_239]
                                        PartitionCols:_col0
                                         Please refer to the previous Select Operator [SEL_234]
                                    <-Select Operator [SEL_283] (rows=43005109025 width=239)
                                        Output:["_col0","_col1","_col2","_col3"]
                                        TableScan [TS_34] (rows=43005109025 width=239)
                                          tpcds_bin_partitioned_orc_30000@catalog_sales,catalog_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_call_center_sk","cs_ext_sales_price","cs_net_profit"]
                  <-Reducer 14 [CONTAINS] vectorized, llap
                    Reduce Output Operator [RS_316]
                      PartitionCols:_col0, _col1, _col2
                      Group By Operator [GBY_315] (rows=924 width=449)
                        Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col2)","sum(_col3)","sum(_col4)"],keys:_col0, _col1, 0L
                        Top N Key Operator [TNK_314] (rows=616 width=439)
                          keys:_col0, _col1,top n:100
                          Select Operator [SEL_313] (rows=509 width=439)
                            Output:["_col0","_col1","_col2","_col3","_col4"]
                            Map Join Operator [MAPJOIN_312] (rows=509 width=456)
                              Conds:GBY_311._col0=RS_310._col0(Left Outer),Output:["_col0","_col1","_col2","_col4","_col5"]
                            <-Reducer 16 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_310]
                                PartitionCols:_col0
                                Group By Operator [GBY_309] (rows=508 width=230)
                                  Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
                                <-Map 15 [SIMPLE_EDGE] vectorized, llap
                                  SHUFFLE [RS_308]
                                    PartitionCols:_col0
                                    Group By Operator [GBY_307] (rows=81280 width=230)
                                      Output:["_col0","_col1","_col2"],aggregations:["sum(_col1)","sum(_col2)"],keys:_col0
                                      Map Join Operator [MAPJOIN_306] (rows=223785373 width=182)
                                        Conds:SEL_305._col3=RS_245._col0(Inner),Output:["_col0","_col1","_col2"]
                                      <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_245]
                                          PartitionCols:_col0
                                           Please refer to the previous Select Operator [SEL_234]
                                      <-Select Operator [SEL_305] (rows=2014206241 width=234)
                                          Output:["_col0","_col1","_col2","_col3"]
                                          Filter Operator [FIL_304] (rows=2014206241 width=234)
                                            predicate:wr_web_page_sk is not null
                                            TableScan [TS_82] (rows=2062802370 width=234)
                                              tpcds_bin_partitioned_orc_30000@web_returns,web_returns, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["wr_web_page_sk","wr_return_amt","wr_net_loss"]
                            <-Group By Operator [GBY_311] (rows=508 width=232)
                                Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
                              <-Map 13 [SIMPLE_EDGE] vectorized, llap
                                SHUFFLE [RS_303]
                                  PartitionCols:_col0
                                  Group By Operator [GBY_302] (rows=1103884 width=231)
                                    Output:["_col0","_col1","_col2"],aggregations:["sum(_col1)","sum(_col2)"],keys:_col0
                                    Map Join Operator [MAPJOIN_301] (rows=2398940204 width=231)
                                      Conds:SEL_300._col3=RS_243._col0(Inner),Output:["_col0","_col1","_col2"]
                                    <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                      BROADCAST [RS_243]
                                        PartitionCols:_col0
                                         Please refer to the previous Select Operator [SEL_234]
                                    <-Select Operator [SEL_300] (rows=21591939929 width=239)
                                        Output:["_col0","_col1","_col2","_col3"]
                                        Filter Operator [FIL_299] (rows=21591939929 width=239)
                                          predicate:ws_web_page_sk is not null
                                          TableScan [TS_67] (rows=21594638446 width=239)
                                            tpcds_bin_partitioned_orc_30000@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_web_page_sk","ws_ext_sales_price","ws_net_profit"]
                  <-Reducer 2 [CONTAINS] vectorized, llap
                    Reduce Output Operator [RS_276]
                      PartitionCols:_col0, _col1, _col2
                      Group By Operator [GBY_275] (rows=924 width=449)
                        Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col2)","sum(_col3)","sum(_col4)"],keys:_col0, _col1, 0L
                        Top N Key Operator [TNK_274] (rows=616 width=439)
                          keys:_col0, _col1,top n:100
                          Select Operator [SEL_273] (rows=99 width=439)
                            Output:["_col0","_col1","_col2","_col3","_col4"]
                            Map Join Operator [MAPJOIN_272] (rows=99 width=454)
                              Conds:GBY_271._col0=RS_270._col0(Left Outer),Output:["_col0","_col1","_col2","_col4","_col5"]
                            <-Reducer 8 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_270]
                                PartitionCols:_col0
                                Group By Operator [GBY_269] (rows=98 width=230)
                                  Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
                                <-Map 7 [SIMPLE_EDGE] vectorized, llap
                                  SHUFFLE [RS_268]
                                    PartitionCols:_col0
                                    Group By Operator [GBY_267] (rows=67620 width=230)
                                      Output:["_col0","_col1","_col2"],aggregations:["sum(_col1)","sum(_col2)"],keys:_col0
                                      Map Join Operator [MAPJOIN_266] (rows=908930661 width=194)
                                        Conds:SEL_265._col3=RS_237._col0(Inner),Output:["_col0","_col1","_col2"]
                                      <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_237]
                                          PartitionCols:_col0
                                           Please refer to the previous Select Operator [SEL_234]
                                      <-Select Operator [SEL_265] (rows=8180935974 width=235)
                                          Output:["_col0","_col1","_col2","_col3"]
                                          Filter Operator [FIL_264] (rows=8180935974 width=235)
                                            predicate:sr_store_sk is not null
                                            TableScan [TS_15] (rows=8332595709 width=235)
                                              tpcds_bin_partitioned_orc_30000@store_returns,store_returns, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["sr_store_sk","sr_return_amt","sr_net_loss"]
                            <-Group By Operator [GBY_271] (rows=98 width=230)
                                Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
                              <-Map 1 [SIMPLE_EDGE] vectorized, llap
                                SHUFFLE [RS_263]
                                  PartitionCols:_col0
                                  Group By Operator [GBY_262] (rows=626318 width=230)
                                    Output:["_col0","_col1","_col2"],aggregations:["sum(_col1)","sum(_col2)"],keys:_col0
                                    Map Join Operator [MAPJOIN_261] (rows=8951525022 width=182)
                                      Conds:SEL_260._col3=RS_235._col0(Inner),Output:["_col0","_col1","_col2"]
                                    <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                      BROADCAST [RS_235]
                                        PartitionCols:_col0
                                         Please refer to the previous Select Operator [SEL_234]
                                    <-Select Operator [SEL_260] (rows=80569240632 width=234)
                                        Output:["_col0","_col1","_col2","_col3"]
                                        Filter Operator [FIL_259] (rows=80569240632 width=234)
                                          predicate:ss_store_sk is not null
                                          TableScan [TS_0] (rows=82510879939 width=234)
                                            tpcds_bin_partitioned_orc_30000@store_sales,store_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ss_store_sk","ss_ext_sales_price","ss_net_profit"]

