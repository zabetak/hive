Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
Map 10 <- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
Reducer 11 <- Map 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 5 vectorized, llap
      File Output Operator [FS_268]
        Select Operator [SEL_267] (rows=100 width=4614)
          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41","_col42","_col43"]
          Limit [LIM_266] (rows=100 width=4510)
            Number of rows:100
            Select Operator [SEL_265] (rows=2122848 width=4510)
              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"]
            <-Reducer 4 [SIMPLE_EDGE] vectorized, llap
              SHUFFLE [RS_264]
                Group By Operator [GBY_263] (rows=2122848 width=4510)
                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)","sum(VALUE._col4)","sum(VALUE._col5)","sum(VALUE._col6)","sum(VALUE._col7)","sum(VALUE._col8)","sum(VALUE._col9)","sum(VALUE._col10)","sum(VALUE._col11)","sum(VALUE._col12)","sum(VALUE._col13)","sum(VALUE._col14)","sum(VALUE._col15)","sum(VALUE._col16)","sum(VALUE._col17)","sum(VALUE._col18)","sum(VALUE._col19)","sum(VALUE._col20)","sum(VALUE._col21)","sum(VALUE._col22)","sum(VALUE._col23)","sum(VALUE._col24)","sum(VALUE._col25)","sum(VALUE._col26)","sum(VALUE._col27)","sum(VALUE._col28)","sum(VALUE._col29)","sum(VALUE._col30)","sum(VALUE._col31)","sum(VALUE._col32)","sum(VALUE._col33)","sum(VALUE._col34)","sum(VALUE._col35)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
                <-Union 3 [SIMPLE_EDGE]
                  <-Reducer 11 [CONTAINS] vectorized, llap
                    Reduce Output Operator [RS_282]
                      PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                      Group By Operator [GBY_281] (rows=4408992 width=4510)
                        Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"],aggregations:["sum(_col6)","sum(_col7)","sum(_col8)","sum(_col9)","sum(_col10)","sum(_col11)","sum(_col12)","sum(_col13)","sum(_col14)","sum(_col15)","sum(_col16)","sum(_col17)","sum(_col18)","sum(_col19)","sum(_col20)","sum(_col21)","sum(_col22)","sum(_col23)","sum(_col24)","sum(_col25)","sum(_col26)","sum(_col27)","sum(_col28)","sum(_col29)","sum(_col30)","sum(_col31)","sum(_col32)","sum(_col33)","sum(_col34)","sum(_col35)","sum(_col36)","sum(_col37)","sum(_col38)","sum(_col39)","sum(_col40)","sum(_col41)"],keys:_col0, _col1, _col2, _col3, _col4, _col5
                        Select Operator [SEL_280] (rows=4408992 width=3166)
                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"]
                          Top N Key Operator [TNK_279] (rows=4408992 width=3166)
                            keys:_col0, _col1, _col2, _col3, _col4, _col5,top n:100
                            Group By Operator [GBY_278] (rows=2204496 width=3166)
                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)","sum(VALUE._col4)","sum(VALUE._col5)","sum(VALUE._col6)","sum(VALUE._col7)","sum(VALUE._col8)","sum(VALUE._col9)","sum(VALUE._col10)","sum(VALUE._col11)","sum(VALUE._col12)","sum(VALUE._col13)","sum(VALUE._col14)","sum(VALUE._col15)","sum(VALUE._col16)","sum(VALUE._col17)","sum(VALUE._col18)","sum(VALUE._col19)","sum(VALUE._col20)","sum(VALUE._col21)","sum(VALUE._col22)","sum(VALUE._col23)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
                            <-Map 10 [SIMPLE_EDGE] vectorized, llap
                              SHUFFLE [RS_277]
                                PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                                Group By Operator [GBY_276] (rows=329545768 width=3166)
                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"],aggregations:["sum(_col6)","sum(_col7)","sum(_col8)","sum(_col9)","sum(_col10)","sum(_col11)","sum(_col12)","sum(_col13)","sum(_col14)","sum(_col15)","sum(_col16)","sum(_col17)","sum(_col18)","sum(_col19)","sum(_col20)","sum(_col21)","sum(_col22)","sum(_col23)","sum(_col24)","sum(_col25)","sum(_col26)","sum(_col27)","sum(_col28)","sum(_col29)"],keys:_col0, _col1, _col2, _col3, _col4, _col5
                                  Select Operator [SEL_275] (rows=329545768 width=750)
                                    Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"]
                                    Map Join Operator [MAPJOIN_274] (rows=329545768 width=750)
                                      Conds:MAPJOIN_273._col2=RS_248._col0(Inner),Output:["_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col22","_col23","_col24","_col25","_col26","_col27"]
                                    <-Map 9 [BROADCAST_EDGE] vectorized, llap
                                      BROADCAST [RS_248]
                                        PartitionCols:_col0
                                        Select Operator [SEL_246] (rows=27 width=486)
                                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
                                          TableScan [TS_12] (rows=27 width=486)
                                            tpcds_bin_partitioned_orc_30000@warehouse,warehouse, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["w_warehouse_sk","w_warehouse_name","w_warehouse_sq_ft","w_city","w_county","w_state","w_country"]
                                    <-Map Join Operator [MAPJOIN_273] (rows=329545768 width=277)
                                        Conds:MAPJOIN_272._col1=RS_245._col0(Inner),Output:["_col2","_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19"]
                                      <-Map 8 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_245]
                                          PartitionCols:_col0
                                          Select Operator [SEL_243] (rows=2 width=8)
                                            Output:["_col0"]
                                            Filter Operator [FIL_242] (rows=2 width=99)
                                              predicate:(sm_carrier) IN ('DIAMOND             ', 'AIRBORNE            ')
                                              TableScan [TS_9] (rows=20 width=99)
                                                tpcds_bin_partitioned_orc_30000@ship_mode,ship_mode, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["sm_ship_mode_sk","sm_carrier"]
                                      <-Map Join Operator [MAPJOIN_272] (rows=3295457622 width=287)
                                          Conds:MAPJOIN_271._col3=RS_236._col0(Inner),Output:["_col1","_col2","_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19"]
                                        <-Map 7 [BROADCAST_EDGE] vectorized, llap
                                          BROADCAST [RS_236]
                                            PartitionCols:_col0
                                            Select Operator [SEL_233] (rows=367 width=56)
                                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12"]
                                              Filter Operator [FIL_232] (rows=367 width=16)
                                                predicate:(d_year = 2002)
                                                TableScan [TS_6] (rows=73049 width=16)
                                                  tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_year","d_moy"]
                                        <-Map Join Operator [MAPJOIN_271] (rows=16513432551 width=247)
                                            Conds:SEL_270._col0=RS_231._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
                                          <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                            BROADCAST [RS_231]
                                              PartitionCols:_col0
                                              Select Operator [SEL_229] (rows=33426 width=8)
                                                Output:["_col0"]
                                                Filter Operator [FIL_228] (rows=33426 width=12)
                                                  predicate:t_time BETWEEN 49530 AND 78330
                                                  TableScan [TS_3] (rows=86400 width=12)
                                                    tpcds_bin_partitioned_orc_30000@time_dim,time_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["t_time_sk","t_time"]
                                          <-Select Operator [SEL_270] (rows=42684154825 width=255)
                                              Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                              Filter Operator [FIL_269] (rows=42684154825 width=259)
                                                predicate:(cs_warehouse_sk is not null and cs_ship_mode_sk is not null and cs_sold_time_sk is not null)
                                                TableScan [TS_32] (rows=43005109025 width=259)
                                                  tpcds_bin_partitioned_orc_30000@catalog_sales,catalog_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_sold_time_sk","cs_ship_mode_sk","cs_warehouse_sk","cs_quantity","cs_ext_sales_price","cs_net_paid_inc_ship_tax"]
                  <-Reducer 2 [CONTAINS] vectorized, llap
                    Reduce Output Operator [RS_262]
                      PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                      Group By Operator [GBY_261] (rows=4408992 width=4510)
                        Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"],aggregations:["sum(_col6)","sum(_col7)","sum(_col8)","sum(_col9)","sum(_col10)","sum(_col11)","sum(_col12)","sum(_col13)","sum(_col14)","sum(_col15)","sum(_col16)","sum(_col17)","sum(_col18)","sum(_col19)","sum(_col20)","sum(_col21)","sum(_col22)","sum(_col23)","sum(_col24)","sum(_col25)","sum(_col26)","sum(_col27)","sum(_col28)","sum(_col29)","sum(_col30)","sum(_col31)","sum(_col32)","sum(_col33)","sum(_col34)","sum(_col35)","sum(_col36)","sum(_col37)","sum(_col38)","sum(_col39)","sum(_col40)","sum(_col41)"],keys:_col0, _col1, _col2, _col3, _col4, _col5
                        Select Operator [SEL_260] (rows=4408992 width=3166)
                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29","_col30","_col31","_col32","_col33","_col34","_col35","_col36","_col37","_col38","_col39","_col40","_col41"]
                          Top N Key Operator [TNK_259] (rows=4408992 width=3166)
                            keys:_col0, _col1, _col2, _col3, _col4, _col5,top n:100
                            Group By Operator [GBY_258] (rows=2204496 width=3166)
                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)","sum(VALUE._col4)","sum(VALUE._col5)","sum(VALUE._col6)","sum(VALUE._col7)","sum(VALUE._col8)","sum(VALUE._col9)","sum(VALUE._col10)","sum(VALUE._col11)","sum(VALUE._col12)","sum(VALUE._col13)","sum(VALUE._col14)","sum(VALUE._col15)","sum(VALUE._col16)","sum(VALUE._col17)","sum(VALUE._col18)","sum(VALUE._col19)","sum(VALUE._col20)","sum(VALUE._col21)","sum(VALUE._col22)","sum(VALUE._col23)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
                            <-Map 1 [SIMPLE_EDGE] vectorized, llap
                              SHUFFLE [RS_257]
                                PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                                Group By Operator [GBY_256] (rows=167846753 width=3166)
                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"],aggregations:["sum(_col6)","sum(_col7)","sum(_col8)","sum(_col9)","sum(_col10)","sum(_col11)","sum(_col12)","sum(_col13)","sum(_col14)","sum(_col15)","sum(_col16)","sum(_col17)","sum(_col18)","sum(_col19)","sum(_col20)","sum(_col21)","sum(_col22)","sum(_col23)","sum(_col24)","sum(_col25)","sum(_col26)","sum(_col27)","sum(_col28)","sum(_col29)"],keys:_col0, _col1, _col2, _col3, _col4, _col5
                                  Select Operator [SEL_255] (rows=167846753 width=750)
                                    Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28","_col29"]
                                    Map Join Operator [MAPJOIN_254] (rows=167846753 width=750)
                                      Conds:MAPJOIN_253._col2=RS_247._col0(Inner),Output:["_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col22","_col23","_col24","_col25","_col26","_col27"]
                                    <-Map 9 [BROADCAST_EDGE] vectorized, llap
                                      BROADCAST [RS_247]
                                        PartitionCols:_col0
                                         Please refer to the previous Select Operator [SEL_246]
                                    <-Map Join Operator [MAPJOIN_253] (rows=167846753 width=279)
                                        Conds:MAPJOIN_252._col1=RS_244._col0(Inner),Output:["_col2","_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19"]
                                      <-Map 8 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_244]
                                          PartitionCols:_col0
                                           Please refer to the previous Select Operator [SEL_243]
                                      <-Map Join Operator [MAPJOIN_252] (rows=1678467504 width=287)
                                          Conds:MAPJOIN_251._col3=RS_234._col0(Inner),Output:["_col1","_col2","_col4","_col5","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19"]
                                        <-Map 7 [BROADCAST_EDGE] vectorized, llap
                                          BROADCAST [RS_234]
                                            PartitionCols:_col0
                                             Please refer to the previous Select Operator [SEL_233]
                                        <-Map Join Operator [MAPJOIN_251] (rows=8351291272 width=247)
                                            Conds:SEL_250._col0=RS_230._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
                                          <-Map 6 [BROADCAST_EDGE] vectorized, llap
                                            BROADCAST [RS_230]
                                              PartitionCols:_col0
                                               Please refer to the previous Select Operator [SEL_229]
                                          <-Select Operator [SEL_250] (rows=21586536205 width=255)
                                              Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                              Filter Operator [FIL_249] (rows=21586536205 width=259)
                                                predicate:(ws_sold_time_sk is not null and ws_ship_mode_sk is not null and ws_warehouse_sk is not null)
                                                TableScan [TS_0] (rows=21594638446 width=259)
                                                  tpcds_bin_partitioned_orc_30000@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_sold_time_sk","ws_ship_mode_sk","ws_warehouse_sk","ws_quantity","ws_sales_price","ws_net_paid_inc_tax"]

