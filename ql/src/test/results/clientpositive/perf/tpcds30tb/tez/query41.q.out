Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Reducer 5 (BROADCAST_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Map 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:100
    Stage-1
      Reducer 3 vectorized, llap
      File Output Operator [FS_63]
        Limit [LIM_62] (rows=100 width=107)
          Number of rows:100
          Select Operator [SEL_61] (rows=202 width=107)
            Output:["_col0"]
          <-Reducer 2 [SIMPLE_EDGE] vectorized, llap
            SHUFFLE [RS_60]
              Group By Operator [GBY_59] (rows=202 width=107)
                Output:["_col0"],keys:KEY._col0
              <-Map 1 [SIMPLE_EDGE] vectorized, llap
                SHUFFLE [RS_58]
                  PartitionCols:_col0
                  Group By Operator [GBY_57] (rows=202 width=107)
                    Output:["_col0"],keys:_col1
                    Top N Key Operator [TNK_56] (rows=404 width=107)
                      keys:_col1,top n:100
                      Map Join Operator [MAPJOIN_55] (rows=404 width=107)
                        Conds:SEL_54._col0=RS_52._col0(Inner),Output:["_col1"]
                      <-Reducer 5 [BROADCAST_EDGE] vectorized, llap
                        BROADCAST [RS_52]
                          PartitionCols:_col0
                          Select Operator [SEL_51] (rows=28 width=95)
                            Output:["_col0"]
                            Filter Operator [FIL_50] (rows=28 width=103)
                              predicate:(_col1 > 0L)
                              Group By Operator [GBY_49] (rows=84 width=103)
                                Output:["_col0","_col1"],aggregations:["count(VALUE._col0)"],keys:KEY._col0
                              <-Map 4 [SIMPLE_EDGE] vectorized, llap
                                SHUFFLE [RS_48]
                                  PartitionCols:_col0
                                  Group By Operator [GBY_47] (rows=84 width=103)
                                    Output:["_col0","_col1"],aggregations:["count()"],keys:i_manufact
                                    Select Operator [SEL_46] (rows=168 width=450)
                                      Output:["i_manufact"]
                                      Filter Operator [FIL_45] (rows=168 width=450)
                                        predicate:((((i_category = 'Women                                             ') and (i_color) IN ('frosted             ', 'rose                ') and (i_units) IN ('Lb        ', 'Gross     ') and (i_size) IN ('medium              ', 'large               ')) or ((i_category = 'Women                                             ') and (i_color) IN ('chocolate           ', 'black               ') and (i_units) IN ('Box       ', 'Dram      ') and (i_size) IN ('economy             ', 'petite              ')) or ((i_category = 'Men                                               ') and (i_color) IN ('slate               ', 'magenta             ') and (i_units) IN ('Carton    ', 'Bundle    ') and (i_size) IN ('N/A                 ', 'small               ')) or ((i_category = 'Men                                               ') and (i_color) IN ('cornflower          ', 'firebrick           ') and (i_units) IN ('Pound     ', 'Oz        ') and (i_size) IN ('medium              ', 'large               ')) or ((i_category = 'Women                                             ') and (i_color) IN ('almond              ', 'steel               ') and (i_units) IN ('Tsp       ', 'Case      ') and (i_size) IN ('medium              ', 'large               ')) or ((i_category = 'Women                                             ') and (i_color) IN ('purple              ', 'aquamarine          ') and (i_units) IN ('Bunch     ', 'Gram      ') and (i_size) IN ('economy             ', 'petite              ')) or ((i_category = 'Men                                               ') and (i_color) IN ('lavender            ', 'papaya              ') and (i_units) IN ('Pallet    ', 'Cup       ') and (i_size) IN ('N/A                 ', 'small               ')) or ((i_category = 'Men                                               ') and (i_color) IN ('maroon              ', 'cyan                ') and (i_units) IN ('Each      ', 'N/A       ') and (i_size) IN ('medium              ', 'large               '))) and i_manufact is not null)
                                        TableScan [TS_3] (rows=462000 width=450)
                                          default@item,item, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["i_category","i_manufact","i_size","i_color","i_units"]
                      <-Select Operator [SEL_54] (rows=14511 width=202)
                          Output:["_col0","_col1"]
                          Filter Operator [FIL_53] (rows=14511 width=205)
                            predicate:(i_manufact_id BETWEEN 970 AND 1010 and i_manufact is not null)
                            TableScan [TS_0] (rows=462000 width=205)
                              default@item,i1, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["i_manufact_id","i_manufact","i_product_name"]

