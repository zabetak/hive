Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 4 <- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
Map 6 <- Map 7 (BROADCAST_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2 vectorized, llap
      File Output Operator [FS_152]
        Limit [LIM_151] (rows=100 width=384)
          Number of rows:100
          Select Operator [SEL_150] (rows=21903 width=384)
            Output:["_col0","_col1"]
          <-Map 1 [SIMPLE_EDGE] vectorized, llap
            SHUFFLE [RS_149]
              Select Operator [SEL_148] (rows=21903 width=384)
                Output:["_col1","_col2"]
                Top N Key Operator [TNK_147] (rows=21903 width=284)
                  keys:_col2,top n:100
                  Map Join Operator [MAPJOIN_146] (rows=21903 width=284)
                    Conds:MAPJOIN_145._col1=RS_142._col1(Inner),Output:["_col2","_col6"]
                  <-Map 4 [BROADCAST_EDGE] vectorized, llap
                    BROADCAST [RS_142]
                      PartitionCols:_col1
                      Map Join Operator [MAPJOIN_141] (rows=22691 width=284)
                        Conds:MAPJOIN_140._col2=RS_137._col0(Inner),Output:["_col0","_col1","_col4"]
                      <-Map 6 [BROADCAST_EDGE] vectorized, llap
                        BROADCAST [RS_137]
                          PartitionCols:_col0
                          Map Join Operator [MAPJOIN_136] (rows=2161 width=8)
                            Conds:SEL_135._col1=RS_133._col0(Inner),Output:["_col0"]
                          <-Map 7 [BROADCAST_EDGE] vectorized, llap
                            BROADCAST [RS_133]
                              PartitionCols:_col0
                              Select Operator [SEL_132] (rows=6 width=8)
                                Output:["_col0"]
                                Filter Operator [FIL_131] (rows=6 width=16)
                                  predicate:((ib_lower_bound >= 32287) and (ib_upper_bound <= 82287))
                                  TableScan [TS_14] (rows=20 width=16)
                                    default@income_band,income_band, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ib_income_band_sk","ib_lower_bound","ib_upper_bound"]
                          <-Select Operator [SEL_135] (rows=7200 width=16)
                              Output:["_col0","_col1"]
                              Filter Operator [FIL_134] (rows=7200 width=16)
                                predicate:hd_income_band_sk is not null
                                TableScan [TS_11] (rows=7200 width=16)
                                  default@household_demographics,household_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["hd_demo_sk","hd_income_band_sk"]
                      <-Map Join Operator [MAPJOIN_140] (rows=75635 width=284)
                          Conds:SEL_139._col3=RS_130._col0(Inner),Output:["_col0","_col1","_col2","_col4"]
                        <-Map 5 [BROADCAST_EDGE] vectorized, llap
                          BROADCAST [RS_130]
                            PartitionCols:_col0
                            Select Operator [SEL_129] (rows=40609 width=8)
                              Output:["_col0"]
                              Filter Operator [FIL_128] (rows=40609 width=101)
                                predicate:(ca_city = 'Hopewell')
                                TableScan [TS_8] (rows=40000000 width=101)
                                  default@customer_address,customer_address, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ca_address_sk","ca_city"]
                        <-Select Operator [SEL_139] (rows=74500295 width=307)
                            Output:["_col0","_col1","_col2","_col3","_col4"]
                            Filter Operator [FIL_138] (rows=74500295 width=303)
                              predicate:(c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null)
                              TableScan [TS_5] (rows=80000000 width=303)
                                default@customer,customer, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["c_customer_id","c_current_cdemo_sk","c_current_hdemo_sk","c_current_addr_sk","c_first_name","c_last_name"]
                  <-Map Join Operator [MAPJOIN_145] (rows=8334169554 width=8)
                      Conds:SEL_144._col0=RS_127._col0(Inner),Output:["_col1"]
                    <-Map 3 [BROADCAST_EDGE] vectorized, llap
                      BROADCAST [RS_127]
                        PartitionCols:_col0
                        Select Operator [SEL_126] (rows=1920800 width=8)
                          Output:["_col0"]
                          TableScan [TS_3] (rows=1920800 width=8)
                            default@customer_demographics,customer_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cd_demo_sk"]
                    <-Select Operator [SEL_144] (rows=8334169554 width=7)
                        Output:["_col0"]
                        Filter Operator [FIL_143] (rows=8334169554 width=7)
                          predicate:sr_cdemo_sk is not null
                          TableScan [TS_0] (rows=8634166995 width=7)
                            default@store_returns,store_returns, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["sr_cdemo_sk"]

