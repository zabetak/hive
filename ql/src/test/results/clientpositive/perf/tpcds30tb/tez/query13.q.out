Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2 vectorized, llap
      File Output Operator [FS_123]
        Select Operator [SEL_122] (rows=1 width=344)
          Output:["_col0","_col1","_col2","_col3"]
          Group By Operator [GBY_121] (rows=1 width=256)
            Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)","count(VALUE._col1)","sum(VALUE._col2)","count(VALUE._col3)","sum(VALUE._col4)","count(VALUE._col5)"]
          <-Map 1 [CUSTOM_SIMPLE_EDGE] vectorized, llap
            PARTITION_ONLY_SHUFFLE [RS_120]
              Group By Operator [GBY_119] (rows=1 width=256)
                Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col3)","count(_col3)","sum(_col4)","count(_col4)","sum(_col5)","count(_col5)"]
                Select Operator [SEL_118] (rows=9256044 width=44)
                  Output:["_col3","_col4","_col5"]
                  Filter Operator [FIL_117] (rows=9256044 width=44)
                    predicate:((_col22 and _col23 and _col10 and _col19) or (_col24 and _col25 and _col11 and _col20) or (_col26 and _col27 and _col12 and _col20))
                    Map Join Operator [MAPJOIN_116] (rows=49365582 width=44)
                      Conds:MAPJOIN_115._col0=RS_109._col0(Inner),Output:["_col3","_col4","_col5","_col10","_col11","_col12","_col19","_col20","_col22","_col23","_col24","_col25","_col26","_col27"]
                    <-Map 6 [BROADCAST_EDGE] vectorized, llap
                      BROADCAST [RS_109]
                        PartitionCols:_col0
                        Select Operator [SEL_108] (rows=493920 width=32)
                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
                          Filter Operator [FIL_107] (rows=493920 width=187)
                            predicate:((cd_marital_status) IN ('M', 'D', 'U') and (cd_education_status) IN ('4 yr Degree         ', 'Primary             ', 'Advanced Degree     '))
                            TableScan [TS_12] (rows=1920800 width=187)
                              tpcds_bin_partitioned_orc_30000@customer_demographics,customer_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cd_demo_sk","cd_marital_status","cd_education_status"]
                    <-Map Join Operator [MAPJOIN_115] (rows=191977250 width=20)
                        Conds:FIL_114._col1=RS_106._col0(Inner),Output:["_col0","_col3","_col4","_col5","_col10","_col11","_col12","_col19","_col20"]
                      <-Map 5 [BROADCAST_EDGE] vectorized, llap
                        BROADCAST [RS_106]
                          PartitionCols:_col0
                          Select Operator [SEL_105] (rows=1440 width=16)
                            Output:["_col0","_col1","_col2"]
                            Filter Operator [FIL_104] (rows=1440 width=12)
                              predicate:(hd_dep_count) IN (3, 1)
                              TableScan [TS_9] (rows=7200 width=12)
                                tpcds_bin_partitioned_orc_30000@household_demographics,household_demographics, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["hd_demo_sk","hd_dep_count"]
                      <-Filter Operator [FIL_114] (rows=959886234 width=36)
                          predicate:((_col15 and _col7) or (_col16 and _col8) or (_col17 and _col9))
                          Map Join Operator [MAPJOIN_113] (rows=1279848314 width=36)
                            Conds:MAPJOIN_112._col2=RS_103._col0(Inner),Output:["_col0","_col1","_col3","_col4","_col5","_col7","_col8","_col9","_col10","_col11","_col12","_col15","_col16","_col17"]
                          <-Map 4 [BROADCAST_EDGE] vectorized, llap
                            BROADCAST [RS_103]
                              PartitionCols:_col0
                              Select Operator [SEL_102] (rows=3396227 width=20)
                                Output:["_col0","_col1","_col2","_col3"]
                                Filter Operator [FIL_101] (rows=3396227 width=191)
                                  predicate:((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States'))
                                  TableScan [TS_6] (rows=40000000 width=191)
                                    tpcds_bin_partitioned_orc_30000@customer_address,customer_address, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ca_address_sk","ca_state","ca_country"]
                          <-Map Join Operator [MAPJOIN_112] (rows=15073766151 width=246)
                              Conds:SEL_111._col6=RS_97._col0(Inner),Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col7","_col8","_col9","_col10","_col11","_col12"]
                            <-Map 3 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_97]
                                PartitionCols:_col0
                                Select Operator [SEL_96] (rows=367 width=8)
                                  Output:["_col0"]
                                  Filter Operator [FIL_95] (rows=367 width=12)
                                    predicate:(d_year = 2001)
                                    TableScan [TS_3] (rows=73049 width=12)
                                      tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_year"]
                              Dynamic Partitioning Event Operator [EVENT_100] (rows=183 width=8)
                                Group By Operator [GBY_99] (rows=183 width=8)
                                  Output:["_col0"],keys:_col0
                                  Select Operator [SEL_98] (rows=367 width=8)
                                    Output:["_col0"]
                                     Please refer to the previous Select Operator [SEL_96]
                            <-Select Operator [SEL_111] (rows=75000207877 width=278)
                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12"]
                                Filter Operator [FIL_110] (rows=75000207877 width=480)
                                  predicate:(ss_cdemo_sk is not null and ss_addr_sk is not null and ss_hdemo_sk is not null and ss_store_sk is not null and ((ss_sales_price >= 100) or (ss_sales_price <= 150) or (ss_sales_price >= 50) or (ss_sales_price <= 100) or (ss_sales_price >= 150) or (ss_sales_price <= 200)) and ((ss_net_profit >= 100) or (ss_net_profit <= 200) or (ss_net_profit >= 150) or (ss_net_profit <= 300) or (ss_net_profit >= 50) or (ss_net_profit <= 250)))
                                  TableScan [TS_0] (rows=82510879939 width=480)
                                    tpcds_bin_partitioned_orc_30000@store_sales,store_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ss_cdemo_sk","ss_hdemo_sk","ss_addr_sk","ss_store_sk","ss_quantity","ss_sales_price","ss_ext_sales_price","ss_ext_wholesale_cost","ss_net_profit"]

