Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 11 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 13 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 5 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 7 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Map 9 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
Reducer 10 <- Map 9 (SIMPLE_EDGE), Reducer 12 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
Reducer 12 <- Map 11 (SIMPLE_EDGE)
Reducer 14 <- Map 13 (SIMPLE_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 6 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 10 vectorized, llap
      File Output Operator [FS_526]
        Select Operator [SEL_525] (rows=482 width=550)
          Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
          Filter Operator [FIL_524] (rows=482 width=778)
            predicate:(CASE WHEN ((_col9 > 0)) THEN (CASE WHEN (_col7) THEN (((_col4 / _col6) > (_col13 / _col9))) ELSE (false) END) ELSE (false) END and CASE WHEN ((_col11 > 0)) THEN (CASE WHEN (_col2) THEN (((_col6 / _col1) > (_col9 / _col11))) ELSE (false) END) ELSE (false) END)
            Map Join Operator [MAPJOIN_523] (rows=1930 width=778)
              Conds:RS_503._col0=MAPJOIN_522._col0(Inner),Output:["_col1","_col2","_col4","_col6","_col7","_col8","_col9","_col11","_col13"]
            <-Reducer 2 [BROADCAST_EDGE] vectorized, llap
              BROADCAST [RS_503]
                PartitionCols:_col0
                Map Join Operator [MAPJOIN_502] (rows=1930 width=442)
                  Conds:MAPJOIN_501._col0=RS_498._col0(Inner),Output:["_col0","_col1","_col2","_col4","_col6","_col7"]
                <-Reducer 8 [BROADCAST_EDGE] vectorized, llap
                  BROADCAST [RS_498]
                    PartitionCols:_col0
                    Select Operator [SEL_497] (rows=1930 width=214)
                      Output:["_col0","_col1","_col2"]
                      Group By Operator [GBY_496] (rows=1930 width=210)
                        Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                      <-Map 7 [SIMPLE_EDGE] vectorized, llap
                        SHUFFLE [RS_495]
                          PartitionCols:_col0
                          Group By Operator [GBY_494] (rows=1721560 width=210)
                            Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                            Map Join Operator [MAPJOIN_493] (rows=1087859189 width=209)
                              Conds:MAPJOIN_492._col0=RS_466._col0(Inner),Output:["_col1","_col5"]
                            <-Map 4 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_466]
                                PartitionCols:_col0
                                Select Operator [SEL_463] (rows=40000000 width=106)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_462] (rows=40000000 width=106)
                                    predicate:ca_county is not null
                                    TableScan [TS_6] (rows=40000000 width=106)
                                      tpcds_bin_partitioned_orc_30000@customer_address,customer_address, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ca_address_sk","ca_county"]
                            <-Map Join Operator [MAPJOIN_492] (rows=1087859189 width=119)
                                Conds:SEL_491._col2=RS_442._col0(Inner),Output:["_col0","_col1"]
                              <-Map 3 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_442]
                                  PartitionCols:_col0
                                  Select Operator [SEL_434] (rows=92 width=8)
                                    Output:["_col0"]
                                    Filter Operator [FIL_428] (rows=92 width=16)
                                      predicate:((d_year = 2000) and (d_qoy = 2))
                                      TableScan [TS_3] (rows=73049 width=16)
                                        tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_year","d_qoy"]
                              <-Select Operator [SEL_491] (rows=21591937227 width=127)
                                  Output:["_col0","_col1","_col2"]
                                  Filter Operator [FIL_490] (rows=21591937227 width=127)
                                    predicate:ws_bill_addr_sk is not null
                                    TableScan [TS_40] (rows=21594638446 width=127)
                                      tpcds_bin_partitioned_orc_30000@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_bill_addr_sk","ws_ext_sales_price"]
                <-Map Join Operator [MAPJOIN_501] (rows=1930 width=326)
                    Conds:SEL_500._col0=RS_489._col0(Inner),Output:["_col0","_col1","_col2","_col4"]
                  <-Reducer 6 [BROADCAST_EDGE] vectorized, llap
                    BROADCAST [RS_489]
                      PartitionCols:_col0
                      Group By Operator [GBY_488] (rows=1930 width=210)
                        Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                      <-Map 5 [SIMPLE_EDGE] vectorized, llap
                        SHUFFLE [RS_487]
                          PartitionCols:_col0
                          Group By Operator [GBY_486] (rows=1721560 width=210)
                            Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                            Map Join Operator [MAPJOIN_485] (rows=1087859189 width=209)
                              Conds:MAPJOIN_484._col0=RS_465._col0(Inner),Output:["_col1","_col5"]
                            <-Map 4 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_465]
                                PartitionCols:_col0
                                 Please refer to the previous Select Operator [SEL_463]
                            <-Map Join Operator [MAPJOIN_484] (rows=1087859189 width=119)
                                Conds:SEL_483._col2=RS_440._col0(Inner),Output:["_col0","_col1"]
                              <-Map 3 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_440]
                                  PartitionCols:_col0
                                  Select Operator [SEL_433] (rows=92 width=8)
                                    Output:["_col0"]
                                    Filter Operator [FIL_427] (rows=92 width=16)
                                      predicate:((d_year = 2000) and (d_qoy = 3))
                                       Please refer to the previous TableScan [TS_3]
                              <-Select Operator [SEL_483] (rows=21591937227 width=127)
                                  Output:["_col0","_col1","_col2"]
                                  Filter Operator [FIL_482] (rows=21591937227 width=127)
                                    predicate:ws_bill_addr_sk is not null
                                    TableScan [TS_20] (rows=21594638446 width=127)
                                      tpcds_bin_partitioned_orc_30000@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_bill_addr_sk","ws_ext_sales_price"]
                  <-Select Operator [SEL_500] (rows=1930 width=214)
                      Output:["_col0","_col1","_col2"]
                      Group By Operator [GBY_499] (rows=1930 width=210)
                        Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                      <-Map 1 [SIMPLE_EDGE] vectorized, llap
                        SHUFFLE [RS_481]
                          PartitionCols:_col0
                          Group By Operator [GBY_480] (rows=1721560 width=210)
                            Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                            Map Join Operator [MAPJOIN_479] (rows=1087859189 width=209)
                              Conds:MAPJOIN_478._col0=RS_464._col0(Inner),Output:["_col1","_col5"]
                            <-Map 4 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_464]
                                PartitionCols:_col0
                                 Please refer to the previous Select Operator [SEL_463]
                            <-Map Join Operator [MAPJOIN_478] (rows=1087859189 width=119)
                                Conds:SEL_477._col2=RS_438._col0(Inner),Output:["_col0","_col1"]
                              <-Map 3 [BROADCAST_EDGE] vectorized, llap
                                BROADCAST [RS_438]
                                  PartitionCols:_col0
                                  Select Operator [SEL_432] (rows=92 width=8)
                                    Output:["_col0"]
                                    Filter Operator [FIL_426] (rows=92 width=16)
                                      predicate:((d_year = 2000) and (d_qoy = 1))
                                       Please refer to the previous TableScan [TS_3]
                              <-Select Operator [SEL_477] (rows=21591937227 width=127)
                                  Output:["_col0","_col1","_col2"]
                                  Filter Operator [FIL_476] (rows=21591937227 width=127)
                                    predicate:ws_bill_addr_sk is not null
                                    TableScan [TS_0] (rows=21594638446 width=127)
                                      tpcds_bin_partitioned_orc_30000@web_sales,web_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ws_bill_addr_sk","ws_ext_sales_price"]
            <-Map Join Operator [MAPJOIN_522] (rows=1930 width=434)
                Conds:MAPJOIN_521._col0=RS_519._col0(Inner),Output:["_col0","_col1","_col3","_col5"]
              <-Reducer 14 [BROADCAST_EDGE] vectorized, llap
                BROADCAST [RS_519]
                  PartitionCols:_col0
                  Group By Operator [GBY_518] (rows=1930 width=210)
                    Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                  <-Map 13 [SIMPLE_EDGE] vectorized, llap
                    SHUFFLE [RS_517]
                      PartitionCols:_col0
                      Group By Operator [GBY_516] (rows=4823070 width=210)
                        Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                        Map Join Operator [MAPJOIN_515] (rows=4059030477 width=157)
                          Conds:MAPJOIN_514._col0=RS_469._col0(Inner),Output:["_col1","_col5"]
                        <-Map 4 [BROADCAST_EDGE] vectorized, llap
                          BROADCAST [RS_469]
                            PartitionCols:_col0
                             Please refer to the previous Select Operator [SEL_463]
                        <-Map Join Operator [MAPJOIN_514] (rows=4059030477 width=63)
                            Conds:SEL_513._col2=RS_448._col0(Inner),Output:["_col0","_col1"]
                          <-Map 3 [BROADCAST_EDGE] vectorized, llap
                            BROADCAST [RS_448]
                              PartitionCols:_col0
                              Select Operator [SEL_437] (rows=92 width=8)
                                Output:["_col0"]
                                Filter Operator [FIL_431] (rows=92 width=16)
                                  predicate:((d_year = 2000) and (d_qoy = 3))
                                   Please refer to the previous TableScan [TS_3]
                          <-Select Operator [SEL_513] (rows=80564040039 width=125)
                              Output:["_col0","_col1","_col2"]
                              Filter Operator [FIL_512] (rows=80564040039 width=125)
                                predicate:ss_addr_sk is not null
                                TableScan [TS_100] (rows=82510879939 width=125)
                                  tpcds_bin_partitioned_orc_30000@store_sales,store_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ss_addr_sk","ss_ext_sales_price"]
              <-Map Join Operator [MAPJOIN_521] (rows=1930 width=322)
                  Conds:GBY_520._col0=RS_511._col0(Inner),Output:["_col0","_col1","_col3"]
                <-Reducer 12 [BROADCAST_EDGE] vectorized, llap
                  BROADCAST [RS_511]
                    PartitionCols:_col0
                    Group By Operator [GBY_510] (rows=1930 width=210)
                      Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                    <-Map 11 [SIMPLE_EDGE] vectorized, llap
                      SHUFFLE [RS_509]
                        PartitionCols:_col0
                        Group By Operator [GBY_508] (rows=4823070 width=210)
                          Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                          Map Join Operator [MAPJOIN_507] (rows=4059030477 width=157)
                            Conds:MAPJOIN_506._col0=RS_468._col0(Inner),Output:["_col1","_col5"]
                          <-Map 4 [BROADCAST_EDGE] vectorized, llap
                            BROADCAST [RS_468]
                              PartitionCols:_col0
                               Please refer to the previous Select Operator [SEL_463]
                          <-Map Join Operator [MAPJOIN_506] (rows=4059030477 width=63)
                              Conds:SEL_505._col2=RS_446._col0(Inner),Output:["_col0","_col1"]
                            <-Map 3 [BROADCAST_EDGE] vectorized, llap
                              BROADCAST [RS_446]
                                PartitionCols:_col0
                                Select Operator [SEL_436] (rows=92 width=8)
                                  Output:["_col0"]
                                  Filter Operator [FIL_430] (rows=92 width=16)
                                    predicate:((d_year = 2000) and (d_qoy = 1))
                                     Please refer to the previous TableScan [TS_3]
                            <-Select Operator [SEL_505] (rows=80564040039 width=125)
                                Output:["_col0","_col1","_col2"]
                                Filter Operator [FIL_504] (rows=80564040039 width=125)
                                  predicate:ss_addr_sk is not null
                                  TableScan [TS_80] (rows=82510879939 width=125)
                                    tpcds_bin_partitioned_orc_30000@store_sales,store_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ss_addr_sk","ss_ext_sales_price"]
                <-Group By Operator [GBY_520] (rows=1930 width=210)
                    Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
                  <-Map 9 [SIMPLE_EDGE] vectorized, llap
                    SHUFFLE [RS_475]
                      PartitionCols:_col0
                      Group By Operator [GBY_474] (rows=4823070 width=210)
                        Output:["_col0","_col1"],aggregations:["sum(_col1)"],keys:_col5
                        Map Join Operator [MAPJOIN_473] (rows=4059030477 width=157)
                          Conds:MAPJOIN_472._col0=RS_467._col0(Inner),Output:["_col1","_col5"]
                        <-Map 4 [BROADCAST_EDGE] vectorized, llap
                          BROADCAST [RS_467]
                            PartitionCols:_col0
                             Please refer to the previous Select Operator [SEL_463]
                        <-Map Join Operator [MAPJOIN_472] (rows=4059030477 width=63)
                            Conds:SEL_471._col2=RS_444._col0(Inner),Output:["_col0","_col1"]
                          <-Map 3 [BROADCAST_EDGE] vectorized, llap
                            BROADCAST [RS_444]
                              PartitionCols:_col0
                              Select Operator [SEL_435] (rows=92 width=8)
                                Output:["_col0"]
                                Filter Operator [FIL_429] (rows=92 width=16)
                                  predicate:((d_year = 2000) and (d_qoy = 2))
                                   Please refer to the previous TableScan [TS_3]
                          <-Select Operator [SEL_471] (rows=80564040039 width=125)
                              Output:["_col0","_col1","_col2"]
                              Filter Operator [FIL_470] (rows=80564040039 width=125)
                                predicate:ss_addr_sk is not null
                                TableScan [TS_60] (rows=82510879939 width=125)
                                  tpcds_bin_partitioned_orc_30000@store_sales,store_sales, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ss_addr_sk","ss_ext_sales_price"]

