Warning: Map Join MAPJOIN[316][bigTable=?] in task 'Reducer 6' is a cross product
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[sum($0)])
  HiveProject(sales=[$0])
    HiveUnion(all=[true])
      HiveProject(sales=[*(CAST($3):DECIMAL(10, 0), $4)])
        HiveSemiJoin(condition=[=($2, $7)], joinType=[semi])
          HiveJoin(condition=[=($1, $0)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ss_customer_sk=[$0])
              HiveAggregate(group=[{0}])
                HiveJoin(condition=[>($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(ss_customer_sk=[$0], $f1=[$1])
                    HiveFilter(condition=[IS NOT NULL($1)])
                      HiveAggregate(group=[{0}], agg#0=[sum($1)])
                        HiveProject(ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                          HiveFilter(condition=[IS NOT NULL($2)])
                            HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                  HiveProject(*=[*(0.95:DECIMAL(3, 2), $0)])
                    HiveFilter(condition=[IS NOT NULL($0)])
                      HiveProject($f0=[$0])
                        HiveAggregate(group=[{}], agg#0=[max($1)])
                          HiveProject(ss_customer_sk=[$0], $f1=[$1])
                            HiveAggregate(group=[{1}], agg#0=[sum($2)])
                              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                                HiveProject(ss_sold_date_sk=[$22], ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                                  HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                                    HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                                HiveProject(d_date_sk=[$0])
                                  HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                                    HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
            HiveJoin(condition=[=($4, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(cs_bill_customer_sk=[$2], cs_item_sk=[$14], cs_quantity=[$17], cs_list_price=[$19], cs_sold_date_sk=[$33])
                HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))])
                  HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, catalog_sales]], table:alias=[catalog_sales])
              HiveProject(d_date_sk=[$0])
                HiveFilter(condition=[AND(=($6, 1999), =($8, 1))])
                  HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
          HiveProject($f1=[$0])
            HiveFilter(condition=[>($2, 4)])
              HiveProject(i_item_sk=[$1], d_date=[$0], $f2=[$2])
                HiveAggregate(group=[{3, 4}], agg#0=[count()])
                  HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22])
                        HiveFilter(condition=[IS NOT NULL($22)])
                          HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                      HiveProject(d_date_sk=[$0], d_date=[$2])
                        HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                          HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
                    HiveProject(i_item_sk=[$0], substr=[substr($4, 1, 30)])
                      HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, item]], table:alias=[item])
      HiveProject(sales=[*(CAST($3):DECIMAL(10, 0), $4)])
        HiveSemiJoin(condition=[=($1, $7)], joinType=[semi])
          HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ss_customer_sk=[$0])
              HiveAggregate(group=[{0}])
                HiveJoin(condition=[>($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(ss_customer_sk=[$0], $f1=[$1])
                    HiveFilter(condition=[IS NOT NULL($1)])
                      HiveAggregate(group=[{0}], agg#0=[sum($1)])
                        HiveProject(ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                          HiveFilter(condition=[IS NOT NULL($2)])
                            HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                  HiveProject(*=[*(0.95:DECIMAL(3, 2), $0)])
                    HiveFilter(condition=[IS NOT NULL($0)])
                      HiveProject($f0=[$0])
                        HiveAggregate(group=[{}], agg#0=[max($1)])
                          HiveProject(ss_customer_sk=[$0], $f1=[$1])
                            HiveAggregate(group=[{1}], agg#0=[sum($2)])
                              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                                HiveProject(ss_sold_date_sk=[$22], ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                                  HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                                    HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                                HiveProject(d_date_sk=[$0])
                                  HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                                    HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
            HiveJoin(condition=[=($4, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ws_item_sk=[$2], ws_bill_customer_sk=[$3], ws_quantity=[$17], ws_list_price=[$19], ws_sold_date_sk=[$33])
                HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                  HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, web_sales]], table:alias=[web_sales])
              HiveProject(d_date_sk=[$0])
                HiveFilter(condition=[AND(=($6, 1999), =($8, 1))])
                  HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
          HiveProject($f1=[$0])
            HiveFilter(condition=[>($2, 4)])
              HiveProject(i_item_sk=[$1], d_date=[$0], $f2=[$2])
                HiveAggregate(group=[{3, 4}], agg#0=[count()])
                  HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22])
                        HiveFilter(condition=[IS NOT NULL($22)])
                          HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, store_sales]], table:alias=[store_sales])
                      HiveProject(d_date_sk=[$0], d_date=[$2])
                        HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                          HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, date_dim]], table:alias=[date_dim])
                    HiveProject(i_item_sk=[$0], substr=[substr($4, 1, 30)])
                      HiveTableScan(table=[[tpcds_bin_partitioned_orc_30000, item]], table:alias=[item])

