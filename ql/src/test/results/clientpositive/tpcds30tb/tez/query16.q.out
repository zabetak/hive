Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 10 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
Map 11 <- Reducer 7 (BROADCAST_EDGE)
Map 12 <- Reducer 6 (BROADCAST_EDGE)
Reducer 13 <- Map 12 (SIMPLE_EDGE)
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Map 11 (CUSTOM_SIMPLE_EDGE)
Reducer 3 <- Reducer 13 (CUSTOM_SIMPLE_EDGE), Reducer 2 (CUSTOM_SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (CUSTOM_SIMPLE_EDGE)
Reducer 6 <- Reducer 2 (CUSTOM_SIMPLE_EDGE)
Reducer 7 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 5 vectorized, llap
      File Output Operator [FS_172]
        Group By Operator [GBY_171] (rows=1 width=232)
          Output:["_col0","_col1","_col2"],aggregations:["count(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
        <-Reducer 4 [CUSTOM_SIMPLE_EDGE] vectorized, llap
          PARTITION_ONLY_SHUFFLE [RS_170]
            Group By Operator [GBY_169] (rows=1 width=232)
              Output:["_col0","_col1","_col2"],aggregations:["count(_col0)","sum(_col1)","sum(_col2)"]
              Group By Operator [GBY_168] (rows=8925676 width=232)
                Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
              <-Reducer 3 [SIMPLE_EDGE] vectorized, llap
                SHUFFLE [RS_167]
                  PartitionCols:_col0
                  Group By Operator [GBY_166] (rows=8925676 width=232)
                    Output:["_col0","_col2","_col3"],aggregations:["sum(_col5)","sum(_col6)"],keys:_col4
                    Select Operator [SEL_165] (rows=17851352 width=178)
                      Output:["_col4","_col5","_col6"]
                      Filter Operator [FIL_164] (rows=17851352 width=178)
                        predicate:_col13 is null
                        Map Join Operator [MAPJOIN_163] (rows=35702704 width=178)
                          Conds:RS_37.KEY.reducesinkkey0=RS_162.KEY.reducesinkkey0(Left Outer),DynamicPartitionHashJoin:true,Output:["_col4","_col5","_col6","_col13"]
                        <-Reducer 13 [CUSTOM_SIMPLE_EDGE] vectorized, llap
                          PARTITION_ONLY_SHUFFLE [RS_162]
                            PartitionCols:_col1
                            Select Operator [SEL_161] (rows=2681654419 width=12)
                              Output:["_col0","_col1"]
                              Group By Operator [GBY_160] (rows=2681654419 width=8)
                                Output:["_col0"],keys:KEY._col0
                              <-Map 12 [SIMPLE_EDGE] vectorized, llap
                                SHUFFLE [RS_159]
                                  PartitionCols:_col0
                                  Group By Operator [GBY_158] (rows=4320980099 width=8)
                                    Output:["_col0"],keys:cr_order_number
                                    Filter Operator [FIL_157] (rows=4320980099 width=8)
                                      predicate:(cr_order_number BETWEEN DynamicValue(RS_37_cs1_cs_order_number_min) AND DynamicValue(RS_37_cs1_cs_order_number_max) and in_bloom_filter(cr_order_number, DynamicValue(RS_37_cs1_cs_order_number_bloom_filter)))
                                      TableScan [TS_25] (rows=4320980099 width=8)
                                        tpcds_bin_partitioned_orc_30000@catalog_returns,cr1, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cr_order_number"]
                                      <-Reducer 6 [BROADCAST_EDGE] vectorized, llap
                                        BROADCAST [RS_156]
                                          Group By Operator [GBY_155] (rows=1 width=24)
                                            Output:["_col0","_col1","_col2"],aggregations:["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1869746)"]
                                          <-Reducer 2 [CUSTOM_SIMPLE_EDGE] llap
                                            PARTITION_ONLY_SHUFFLE [RS_116]
                                              Group By Operator [GBY_115] (rows=1 width=24)
                                                Output:["_col0","_col1","_col2"],aggregations:["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=1869746)"]
                                                Select Operator [SEL_114] (rows=17851352 width=16)
                                                  Output:["_col0"]
                                                  Select Operator [SEL_36] (rows=17851352 width=120)
                                                    Output:["_col4","_col5","_col6"]
                                                    Map Join Operator [MAPJOIN_124] (rows=17851352 width=120)
                                                      Conds:RS_145.KEY.reducesinkkey0=RS_154.KEY.reducesinkkey0(Left Semi),DynamicPartitionHashJoin:true,Output:["_col3","_col4","_col5","_col6","_col14"],residual filter predicates:{(_col3 <> _col14)}
                                                    <-Map 11 [CUSTOM_SIMPLE_EDGE] vectorized, llap
                                                      PARTITION_ONLY_SHUFFLE [RS_154]
                                                        PartitionCols:_col0
                                                        Group By Operator [GBY_153] (rows=43005584639 width=15)
                                                          Output:["_col0","_col1"],keys:_col0, _col1
                                                          Select Operator [SEL_152] (rows=43005584639 width=15)
                                                            Output:["_col0","_col1"]
                                                            Filter Operator [FIL_151] (rows=43005584639 width=15)
                                                              predicate:(cs_warehouse_sk is not null and cs_order_number BETWEEN DynamicValue(RS_33_cs1_cs_order_number_min) AND DynamicValue(RS_33_cs1_cs_order_number_max) and in_bloom_filter(cs_order_number, DynamicValue(RS_33_cs1_cs_order_number_bloom_filter)))
                                                              TableScan [TS_22] (rows=43220864887 width=15)
                                                                tpcds_bin_partitioned_orc_30000@catalog_sales,cs2, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_warehouse_sk","cs_order_number"]
                                                              <-Reducer 7 [BROADCAST_EDGE] vectorized, llap
                                                                BROADCAST [RS_150]
                                                                  Group By Operator [GBY_149] (rows=1 width=24)
                                                                    Output:["_col0","_col1","_col2"],aggregations:["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1869746)"]
                                                                  <-Map 1 [CUSTOM_SIMPLE_EDGE] vectorized, llap
                                                                    PARTITION_ONLY_SHUFFLE [RS_148]
                                                                      Group By Operator [GBY_147] (rows=1 width=24)
                                                                        Output:["_col0","_col1","_col2"],aggregations:["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=1869746)"]
                                                                        Select Operator [SEL_146] (rows=17851352 width=16)
                                                                          Output:["_col0"]
                                                                          Map Join Operator [MAPJOIN_144] (rows=17851352 width=120)
                                                                            Conds:MAPJOIN_143._col0=RS_139._col0(Inner),Output:["_col3","_col4","_col5","_col6"]
                                                                          <-Map 10 [BROADCAST_EDGE] vectorized, llap
                                                                            BROADCAST [RS_139]
                                                                              PartitionCols:_col0
                                                                              Select Operator [SEL_138] (rows=8116 width=64)
                                                                                Output:["_col0"]
                                                                                Filter Operator [FIL_137] (rows=8116 width=64)
                                                                                  predicate:CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP'2001-04-01 00:00:00' AND TIMESTAMP'2001-05-31 00:00:00'
                                                                                  TableScan [TS_9] (rows=73049 width=64)
                                                                                    tpcds_bin_partitioned_orc_30000@date_dim,date_dim, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["d_date_sk","d_date"]
                                                                          <-Map Join Operator [MAPJOIN_143] (rows=160673164 width=120)
                                                                              Conds:MAPJOIN_142._col2=RS_136._col0(Inner),Output:["_col0","_col3","_col4","_col5","_col6"]
                                                                            <-Map 9 [BROADCAST_EDGE] vectorized, llap
                                                                              BROADCAST [RS_136]
                                                                                PartitionCols:_col0
                                                                                Select Operator [SEL_135] (rows=12 width=106)
                                                                                  Output:["_col0"]
                                                                                  Filter Operator [FIL_134] (rows=12 width=106)
                                                                                    predicate:(cc_county) IN ('Ziebach County', 'Levy County', 'Huron County', 'Franklin Parish', 'Daviess County')
                                                                                    TableScan [TS_6] (rows=60 width=106)
                                                                                      tpcds_bin_partitioned_orc_30000@call_center,call_center, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cc_call_center_sk","cc_county"]
                                                                            <-Map Join Operator [MAPJOIN_142] (rows=803365808 width=219)
                                                                                Conds:SEL_141._col1=RS_133._col0(Inner),Output:["_col0","_col2","_col3","_col4","_col5","_col6"]
                                                                              <-Map 8 [BROADCAST_EDGE] vectorized, llap
                                                                                BROADCAST [RS_133]
                                                                                  PartitionCols:_col0
                                                                                  Select Operator [SEL_132] (rows=754717 width=94)
                                                                                    Output:["_col0"]
                                                                                    Filter Operator [FIL_131] (rows=754717 width=94)
                                                                                      predicate:(ca_state = 'NY')
                                                                                      TableScan [TS_3] (rows=40000000 width=94)
                                                                                        tpcds_bin_partitioned_orc_30000@customer_address,customer_address, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["ca_address_sk","ca_state"]
                                                                              <-Select Operator [SEL_141] (rows=42578387146 width=263)
                                                                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
                                                                                  Filter Operator [FIL_140] (rows=42578387146 width=263)
                                                                                    predicate:(cs_ship_addr_sk is not null and cs_ship_date_sk is not null and cs_call_center_sk is not null)
                                                                                    TableScan [TS_0] (rows=43220864887 width=263)
                                                                                      tpcds_bin_partitioned_orc_30000@catalog_sales,cs1, ACID table,Tbl:COMPLETE,Col:COMPLETE,Output:["cs_ship_date_sk","cs_ship_addr_sk","cs_call_center_sk","cs_warehouse_sk","cs_order_number","cs_ext_ship_cost","cs_net_profit"]
                                                    <-Map 1 [CUSTOM_SIMPLE_EDGE] vectorized, llap
                                                      PARTITION_ONLY_SHUFFLE [RS_145]
                                                        PartitionCols:_col4
                                                         Please refer to the previous Map Join Operator [MAPJOIN_144]
                        <-Reducer 2 [CUSTOM_SIMPLE_EDGE] llap
                          PARTITION_ONLY_SHUFFLE [RS_37]
                            PartitionCols:_col4
                             Please refer to the previous Select Operator [SEL_36]

